{% extends "base.html" %}
{% block content %}
<div style="text-align: center;">
    <h2>{{ photo.caption }}</h2>
    <img src="{{ photo.image.url }}" alt="{{ photo.caption }}" style="max-width: 100%; height: auto;">

    <div style="margin: 20px 0;">
        <p><strong>Автор:</strong> {{ photo.author.first_name|default:photo.author.username }}</p>
        <p><strong>Дата:</strong> {{ photo.created_at|date:"d.m.Y H:i" }}</p>
        {% if photo.album %}
            <p><strong>Альбом:</strong> <a href="{% url 'webapp:album_detail' photo.album.pk %}">{{ photo.album.title }}</a></p>
        {% endif %}
        <p><strong>Лайков:</strong> {{ photo.favorites_count }}</p>
    </div>

    {% if user.is_authenticated %}
        {% if photo.is_public %}
            <form method="POST" action="{% url 'webapp:photo_fav_toggle' photo.pk %}" style="display: inline;">
                {% csrf_token %}
                <button type="submit">
                    {% if user in photo.favorited_by.all %}
                        Убрать из избранного
                    {% else %}
                        Добавить в избранное
                    {% endif %}
                </button>
            </form>
        {% endif %}

        {% if user == photo.author %}
            <a href="{% url 'webapp:photo_edit' photo.pk %}" style="margin-left: 10px;">Редактировать</a>
            <a href="{% url 'webapp:photo_delete' photo.pk %}"
               onclick="return confirm('Удалить фото?')"
               style="margin-left: 10px; color: red;">Удалить</a>
        {% endif %}
    {% endif %}
</div>

<div style="text-align: center; margin-top: 20px;">
    <a href="{% url 'webapp:photo_list' %}">← Вернуться к галерее</a>
</div>
{% endblock %}